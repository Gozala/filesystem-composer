<!DOCTYPE html>  <html> <head>   <title>files.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="attributes.html">                 attributes.js               </a>                                           <a class="source" href="directories.html">                 directories.js               </a>                                           <a class="source" href="files.html">                 files.js               </a>                                           <a class="source" href="fs-base.html">                 fs-base.js               </a>                                           <a class="source" href="fs.html">                 fs.js               </a>                                           <a class="source" href="listing.html">                 listing.js               </a>                                           <a class="source" href="paths.html">                 paths.js               </a>                                           <a class="source" href="permissions.html">                 permissions.js               </a>                                           <a class="source" href="tests.html">                 tests.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               files.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-1">#</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span>

<span class="kd">var</span> <span class="nx">Trait</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;light-traits&#39;</span><span class="p">).</span><span class="nx">Trait</span>
<span class="p">,</span>   <span class="nx">all</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;promised-utils&#39;</span><span class="p">).</span><span class="nx">all</span>
<span class="p">,</span>   <span class="nx">Q</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">),</span> <span class="nx">when</span> <span class="o">=</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">when</span><span class="p">,</span> <span class="nx">asap</span> <span class="o">=</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">asap</span><span class="p">,</span> <span class="nx">defer</span> <span class="o">=</span> <span class="nx">Q</span><span class="p">.</span><span class="nx">defer</span>
<span class="p">,</span>   <span class="nx">Callback</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./utils/promised&#39;</span><span class="p">).</span><span class="nx">Callback</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">FSFilesTrait</span> <span class="o">=</span> <span class="nx">Trait</span><span class="p">(</span>
<span class="p">{</span> <span class="nx">_remove</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
<span class="p">,</span> <span class="nx">_touch</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
<span class="p">,</span> <span class="nx">_read</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
<span class="p">,</span> <span class="nx">_write</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-2">#</a>               </div>               <p>function returns promise for an <code>IO</code> stream that supports an appropriate
interface for the given options and mode, which include reading, writing,
updating, byte, character, unbuffered, buffered, and line buffered streams.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   *  @param {String()} path</span>
<span class="cm">   *      any value coercible to a String, including a Path, that can be</span>
<span class="cm">   *      interpreted as a fully-qualified path, or a path relative to</span>
<span class="cm">   *      the current working directory.</span>
<span class="cm">   *  @param {String} mode</span>
<span class="cm">   *      any subtring of &quot;rwa+bxc&quot; meaning &quot;read&quot;, &quot;write&quot;, &quot;append&quot;, </span>
<span class="cm">   *      &quot;update&quot;, &quot;binary&quot;, and &quot;exclusive&quot; flags respectively, in any</span>
<span class="cm">   *      order.</span>
<span class="cm">   *  @param {Object} mode</span>
<span class="cm">   *  @param {String} mode.mode</span>
<span class="cm">   *      conforming to the above mentioned mode string pattern</span>
<span class="cm">   *  @param {String} mode.charset</span>
<span class="cm">   *      an IANA, case insensitive, charset name. open must throw a </span>
<span class="cm">   *      #TODO error if the charset is not supported. The ascii and</span>
<span class="cm">   *      utf-8 charsets must be supported.</span>
<span class="cm">   *  @param {Boolean} mode.read</span>
<span class="cm">   *      open for reading, do not create, set position to beginning of</span>
<span class="cm">   *      the file, throw an error if the file does not exist.</span>
<span class="cm">   *  @param {Boolean} mode.write</span>
<span class="cm">   *      open for writing, create or truncate, set position to the </span>
<span class="cm">   *      beginning of the file.</span>
<span class="cm">   *  @param {Boolean} mode.append</span>
<span class="cm">   *      open for appending, create if it doesn&#39;t exist, do not</span>
<span class="cm">   *      truncate, set position to end of the file.</span>
<span class="cm">   *  @param {Boolean} mode.update</span>
<span class="cm">   *      open for updating, create if it doesn&#39;t exist, do not </span>
<span class="cm">   *      truncate, set position to the beginning of the file.</span>
<span class="cm">   *  @param {Boolean} mode.binary</span>
<span class="cm">   *      return a raw stream instead of a buffered, charset encoded,</span>
<span class="cm">   *      text</span>
<span class="cm">   *  @param {Boolean} mode.exclusive</span>
<span class="cm">   *      open for write only if it does not already exist, otherwise</span>
<span class="cm">   *      throw an error.</span>
<span class="cm">   *  @returns {Promise}</span>
<span class="cm">   *  @resolves {Object}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">open</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-3">#</a>               </div>               <p>Removes the file at the given path. Throws an exception if the 
path corresponds to anything that is not a file or a symbolic 
link. If <code>path</code> refers to a symbolic link, removes the symbolic
link.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|Path)|String} path</span>
<span class="cm">   * @returns {Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">remove</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">deferred</span><span class="p">()</span>
    <span class="nx">asap</span>
    <span class="p">(</span> <span class="nx">path</span>
    <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">Callback</span><span class="p">(</span><span class="nx">deferred</span><span class="p">))</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">reject</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-4">#</a>               </div>               <p>returns the names of all the files in a directory, in lexically
sorted order. Throws an exception if the directory cannot be
traversed (or path is not a directory). <br />
Note: this means that <code>list("x")</code> of a directory containing <code>"a"</code>
and <code>"b"</code> would return <code>["a", "b"]</code>, not <code>["x/a", "x/b"]</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|Path)|String} path</span>
<span class="cm">   * @param {Permissions(Promise(Object|String)|String|Object)} options</span>
<span class="cm">   * @returns {Promise &lt;&lt; String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">read</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">read</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">defer</span><span class="p">()</span>
    <span class="nx">asap</span>
    <span class="p">(</span> <span class="nx">path</span>
    <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_read</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">Callback</span><span class="p">(</span><span class="nx">deferred</span><span class="p">))</span>
      <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="p">,</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">reject</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-5">#</a>               </div>               <p>Opens, writes, flushes, and closes a file with the given content.
If the content is a ByteArray or ByteString, the binary mode is
implied. Equivalent to 
<code>open(source, mode + "w" + (content instanceof Binary ? "b" : ""))
    .write(content).flush()</code>
for mode Strings.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|Path)|String} path</span>
<span class="cm">   * @param {String(Promise|String)} content</span>
<span class="cm">   * @param {Permissions(Promise(Object|String)|String|Object)} options</span>
<span class="cm">   * @returns {Promise &lt;&lt; String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">write</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">write</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">defer</span><span class="p">()</span>
    <span class="nx">asap</span>
    <span class="p">(</span> <span class="nx">all</span><span class="p">([</span><span class="nx">path</span><span class="p">,</span> <span class="nx">data</span><span class="p">])</span>
    <span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_write</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;&#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">Callback</span><span class="p">(</span><span class="nx">deferred</span><span class="p">))</span>
      <span class="p">}</span>
    <span class="p">,</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">reject</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="nx">deferred</span><span class="p">.</span><span class="nx">promise</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-6">#</a>               </div>               <p>reads one file and writes another in byte mode. Equivalent to 
<code>open(source, "b").copy(target, "b")</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|String|Path)} source</span>
<span class="cm">   * @param {String(Promise|String|Path)} target</span>
<span class="cm">   * @returns {Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">copy</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">copy</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-7">#</a>               </div>               <p>Changes the name of a file at a given path. This differs from move
in that the target is relative to the source instead of the
current working directory. This method in particular should be
implemented by the native <code>fs-base</code> module overriding any pure
JavaScript implementation, if possible.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|String|Path)} source</span>
<span class="cm">   * @param {String(Promise|String|Path)} target</span>
<span class="cm">   * @returns {Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">rename</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">rename</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-8">#</a>               </div>               <p>Moves a directory from one path to another on the same file system.
Does not copy the directory under any circumstances. A conforming
implementation must move the directory using the operating 
system's file-system-atomic move or rename call. If it cannot be
moved for any reason an exception must be thrown. An exception
must be thrown if <code>target</code> specifies an existing directory.
<em>Note</em>: this is the same method used to move files. The behaviour
differs depending on whether source is a file or directory.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|String|Path)} source</span>
<span class="cm">   * @param {String(Promise|String|Path)} target</span>
<span class="cm">   * @returns {Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">move</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">move</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-9">#</a>               </div>               <p>Sets the modification time of a file or directory at a given path
to a specified time, or the current time. Creates an empty file at
the given path if no file (special or otherwise) or directory
exists, using the default permissions (as though openRaw were
called with no permissions argument). If the underlying file
system does not support milliseconds, the time is truncated (not
rounded) to the nearest supported unit. On file systems that
support last-accessed time, this must be set to match the
modification time. Where possible, the underlying implementation
should insure that file creation and time stamp modification are
transactionally related to the same file, rather than the same
directory entry.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="cm">/**</span>
<span class="cm">   * @param {String(Promise|Path)|String} path</span>
<span class="cm">   * @param {Date(Promise)|Date} date</span>
<span class="cm">   * @returns {Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">touch</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">touch</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">})</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 