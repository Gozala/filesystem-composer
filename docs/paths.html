<!DOCTYPE html>  <html> <head>   <title>paths.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="attributes.html">                 attributes.js               </a>                                           <a class="source" href="directories.html">                 directories.js               </a>                                           <a class="source" href="files.html">                 files.js               </a>                                           <a class="source" href="fs-base.html">                 fs-base.js               </a>                                           <a class="source" href="fs.html">                 fs.js               </a>                                           <a class="source" href="listing.html">                 listing.js               </a>                                           <a class="source" href="paths.html">                 paths.js               </a>                                           <a class="source" href="permissions.html">                 permissions.js               </a>                                           <a class="source" href="tests.html">                 tests.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               paths.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-1">#</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span>

<span class="kd">var</span> <span class="nx">Trait</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;light-traits&#39;</span><span class="p">).</span><span class="nx">Trait</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-2">#</a>               </div>               <p>Array shortcuts</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">,</span>   <span class="nx">_join</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">join</span>
<span class="p">,</span>   <span class="nx">_slice</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span>


<span class="cm">/**</span>
<span class="cm"> * Creates an object implementing all &quot;Path&quot; manipulation APIs from CommonJS</span>
<span class="cm"> * [filesystem](http://wiki.commonjs.org/wiki/Filesystem/A) specification.</span>
<span class="cm"> * All the IO operation are meant to be added as a second tire on top.</span>
<span class="cm"> * @param {Object} source</span>
<span class="cm"> *    Object has to implement `workingDirectory` &amp; `changeWorkingDirectory`</span>
<span class="cm"> *    functions since some of the &quot;Path&quot; manipulation functions (for example</span>
<span class="cm"> *    `absolute`) depend on them.</span>
<span class="cm"> * @param {Function} workingDirectory</span>
<span class="cm"> *    Function syncroniusly should return `String` of working directory on</span>
<span class="cm"> *    underlaying system, analog to `cwd`.</span>
<span class="cm"> * @param {Function} changeWorkingDirectory</span>
<span class="cm"> *    Function call should change working directory on underlying system</span>
<span class="cm"> */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">TextPathTrait</span> <span class="o">=</span> <span class="nx">Trait</span><span class="p">(</span>
<span class="p">{</span> <span class="nx">_separator</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
  <span class="cm">/**</span>
<span class="cm">   * Current working directory. Analog to `pwd`.</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">    */</span>
<span class="p">,</span> <span class="nx">workingDirectory</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
 <span class="cm">/**</span>
<span class="cm">  * Changes working directory, analog to `cd`.</span>
<span class="cm">  * @param {String()} path</span>
<span class="cm">  * @returns {String|Promise}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">changeWorkingDirectory</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
  <span class="cm">/**</span>
<span class="cm">   * Returns true if path is a windows drive, which has `c:` like form.</span>
<span class="cm">   * @param {String} path      top slice from path</span>
<span class="cm">   * @returns {Boolean}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">_isDrive</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_isDrive</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">--</span><span class="nx">path</span><span class="p">.</span><span class="nx">length</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * Returns true if path is absolute.</span>
<span class="cm">   * For absolute paths on any operating system,</span>
<span class="cm">   * the first path component always determines whether it is relative or</span>
<span class="cm">   * absolute.</span>
<span class="cm">   * @example</span>
<span class="cm">   *        // on Unix, it is empty</span>
<span class="cm">   *        [&#39;&#39;, &#39;foo&#39;].join(&#39;/&#39;) == &#39;/foo&#39;</span>
<span class="cm">   *        &#39;/foo&#39;.split(&#39;/&#39;) == [&#39;&#39;, &#39;foo&#39;]</span>
<span class="cm">   *        // while on windows it is has form of drive</span>
<span class="cm">   *        [&#39;c:&#39;, &#39;foo&#39;].join(&#39;\\&#39;) == &#39;c:\\foo&#39;</span>
<span class="cm">   *        &#39;c:\\foo&#39;.split(&#39;\\&#39;) == [&#39;c:&#39;, &#39;foo&#39;]</span>
<span class="cm">   *        // &#39;&#39; is not absolute.</span>
<span class="cm">   *        split(&#39;&#39;) == []</span>
<span class="cm">   *        // &#39;/&#39; is absolute.</span>
<span class="cm">   *        split(&#39;/&#39;) == [&#39;&#39;, &#39;&#39;]</span>
<span class="cm">   * @param {String()}</span>
<span class="cm">   * @returns {Boolean}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">_isAbsolute</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_isAbsolute</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">path</span><span class="p">),</span> <span class="nx">head</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">head</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_isDrive</span><span class="p">(</span><span class="nx">head</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * Takes a variadic list of path Strings, joins them on the file system&#39;s</span>
<span class="cm">   * path separator, and normalizes the result.</span>
<span class="cm">   * [details](http://wiki.commonjs.org/wiki/Filesystem/Join)</span>
<span class="cm">   * @params {String()}</span>
<span class="cm">   * @returns {String()}</span>
<span class="cm">    */</span>
<span class="p">,</span> <span class="nx">join</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">join</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-3">#</a>               </div>               <p>special case for root, helps glob [""] -> "/"</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">===</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_separator</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-4">#</a>               </div>               <p>["", ""] -> "/",
["", "a"] -> "/a"
["a"] -> "a"</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">normal</span><span class="p">(</span><span class="nx">_join</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_separator</span><span class="p">))</span> <span class="o">||</span> <span class="s1">&#39;.&#39;</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns an array of path components. If the path is absolute, the</span>
<span class="cm">   * first component will be an indicator of the root of the file system.</span>
<span class="cm">   * for file systems with drives (such as Windows), this is the drive</span>
<span class="cm">   * identifier with a colon, like `c:`. on Unix, this is an empty string</span>
<span class="cm">   * `&quot;&quot;`. The intent is that calling `join.apply` with the result of</span>
<span class="cm">   * `split` as arguments will reconstruct the path.</span>
<span class="cm">   * @param {String()} path</span>
<span class="cm">   * @return {String[]}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">split</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">split</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">path</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-5">#</a>               </div>               <p>this special case helps isAbsolute
distinguish an empty path from an absolute path
"" -> [] NOT [""]
"a" -> ["a"]
"/a" -> ["", "a"]</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">path</span> <span class="o">?</span> <span class="p">[]</span> <span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_separator</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * function like `join` except that it treats each argument as as either</span>
<span class="cm">   * an absolute or relative path and, as is the convention with URL&#39;s,</span>
<span class="cm">   * treats everything up to the final directory separator as a location,</span>
<span class="cm">   * and everything afterward as an entry in that directory, even if the</span>
<span class="cm">   * entry refers to a directory in the underlying storage. Resolve starts</span>
<span class="cm">   * at the location `&quot;&quot;` and walks to the locations referenced by each</span>
<span class="cm">   * path, and returns the path of the last file. Thus, `resolve(file, &quot;&quot;)`</span>
<span class="cm">   * idempotently refers to the location containing a file or directory</span>
<span class="cm">   * entry, and `resolve(file, neighbor)` always gives the path of a file</span>
<span class="cm">   * in the same directory. `resolve` is useful for finding paths in the</span>
<span class="cm">   * `neighborhood` of a given file, while gracefully accepting both</span>
<span class="cm">   * absolute and relative paths at each stage.</span>
<span class="cm">   * [unit tests](http://github.com/kriskowal/narwhal-test/blob/master/src/test/file/resolve.js).</span>
<span class="cm">   * @params {String()} path</span>
<span class="cm">   * @return {String[]}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">resolve</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">resolve</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">,</span>   <span class="nx">leaf</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">,</span>   <span class="nx">parents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">,</span>   <span class="nx">children</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">,</span>   <span class="nx">_separator</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_separator</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">arguments</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">==</span> <span class="nx">path</span><span class="p">)</span> <span class="k">continue</span>
      <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">_separator</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isAbsolute</span><span class="p">(</span><span class="nx">path</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">root</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span> <span class="o">+</span> <span class="nx">_separator</span>
        <span class="nx">parents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="nx">children</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="p">}</span>
      <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
      <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">===</span> <span class="nx">leaf</span> <span class="o">||</span> <span class="s1">&#39;..&#39;</span> <span class="o">===</span> <span class="nx">leaf</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">parts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">leaf</span><span class="p">)</span>
        <span class="nx">leaf</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
      <span class="p">}</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jj</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jj</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">part</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;..&#39;</span> <span class="o">===</span> <span class="nx">part</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!==</span> <span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">children</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
          <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">root</span><span class="p">)</span> <span class="nx">parents</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">!==</span> <span class="nx">part</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;&#39;</span> <span class="o">!==</span> <span class="nx">part</span><span class="p">)</span> <span class="nx">children</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">part</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">path</span> <span class="o">=</span> <span class="nx">parents</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">children</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="nx">_separator</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">_separator</span> <span class="o">+</span> <span class="nx">leaf</span>
    <span class="k">return</span> <span class="nx">root</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="nx">leaf</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * removes `&#39;.&#39;` path components and simplifies `&#39;..&#39;` paths, if</span>
<span class="cm">   * possible, for a given path.</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">normal</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">resolve</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span> <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns the path of a file&#39;s containing directory, albeit the parent</span>
<span class="cm">   * directory if the file is a directory. A terminal directory separator</span>
<span class="cm">   * is ignored.</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">directory</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">directory</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">())</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">())</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!==</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">parts</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;.&#39;</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns the part of the path that is after the last directory</span>
<span class="cm">   * separator. If an extension is provided and is equal to the file&#39;s</span>
<span class="cm">   * extension, the extension is removed from the result.</span>
<span class="cm">   * @param {String()} path</span>
<span class="cm">   * @param {String()} extension</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">base</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">base</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">extension</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">basename</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">path</span><span class="p">).</span><span class="nx">pop</span><span class="p">()</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="p">(</span><span class="kc">undefined</span> <span class="o">!==</span> <span class="nx">extension</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">extension</span><span class="p">.</span><span class="nx">length</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">extension</span> <span class="o">===</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">l</span><span class="p">))</span> <span class="nx">basename</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">basename</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns the extension of a file. The extension of a file is the last</span>
<span class="cm">   * dot (excluding any number of initial dots) followed by one or more</span>
<span class="cm">   * non-dot characters. Returns an empty string if no valid extension</span>
<span class="cm">   * exists.</span>
<span class="cm">   * [unit test](http://github.com/kriskowal/narwhal-test/blob/master/src/test/file/extension.js).</span>
<span class="cm">   * @param {String()} path</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">extension</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">extension</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">basename</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">base</span><span class="p">(</span><span class="nx">path</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\.+/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="o">&gt;=</span> <span class="nx">index</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns the absolute path, starting with the root of this file</span>
<span class="cm">   * system object, for the given path, resolved from the current</span>
<span class="cm">   * working directory. If the file system supports home directory</span>
<span class="cm">   * aliases, absolute resolves those from the root of the file system.</span>
<span class="cm">   * The resulting path is in normal form. On most systems, this is</span>
<span class="cm">   * equivalent to expanding any user directory alias, joining the path</span>
<span class="cm">   * to the current working directory, and normalizing the result.</span>
<span class="cm">   * &quot;absolute&quot; can be implemented in terms of &quot;workingDirectory&quot;,</span>
<span class="cm">   * &quot;join&quot;, and &quot;normal&quot;.</span>
<span class="cm">   * @param {String()} path</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">absolute</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">absolute</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">workingDirectory</span><span class="p">(),</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="nx">path</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="cm">/*</span>
<span class="cm">   * returns the canonical path to a given abstract path. Canonical paths</span>
<span class="cm">   * are both absolute and intrinsic, such that all paths that refer to a</span>
<span class="cm">   * given file (whether it exists or not) have the same corresponding</span>
<span class="cm">   * canonical path. This function is equivalent to joining the given path</span>
<span class="cm">   * to the current working directory (if the path is relative), joining</span>
<span class="cm">   * all symbolic links along the path, and normalizing the result to</span>
<span class="cm">   * remove relative path (. or ..) references.</span>
<span class="cm">   * When the underlying implementation is built on a Unicode-aware file</span>
<span class="cm">   * system, Unicode normalization must also be performed on the path using</span>
<span class="cm">   * the same normal form as the underlying file system.</span>
<span class="cm">   * * It is not required that paths whose directories do not exist have a</span>
<span class="cm">   * canonical representation. Such paths will be canonicalized as</span>
<span class="cm">   * &quot;undefined&quot;. Note: this point has caused some argument, and the exact</span>
<span class="cm">   * behaviour in this case needs to be determined.</span>
<span class="cm">   * @path {String()} path</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">canonical</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">canonical</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">workingDirectory</span><span class="p">(),</span> <span class="nx">path</span><span class="p">]</span>
    <span class="p">,</span>   <span class="nx">outs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">,</span>   <span class="nx">prev</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ii</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ii</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">paths</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">ins</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_isDrive</span><span class="p">(</span><span class="nx">ins</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="nx">outs</span> <span class="o">=</span> <span class="p">[</span><span class="nx">ins</span><span class="p">.</span><span class="nx">shift</span><span class="p">()]</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">ins</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">leaf</span> <span class="o">=</span> <span class="nx">ins</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span>
        <span class="p">,</span> <span class="nx">consider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">outs</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">leaf</span><span class="p">]))</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-6">#</a>               </div>               <p>cycle breaker; does not throw an error since every
invalid path must also have an intrinsic canonical
name.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">consider</span> <span class="o">==</span> <span class="nx">prev</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">ins</span><span class="p">.</span><span class="nx">unshift</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">ins</span><span class="p">,</span> <span class="nx">split</span><span class="p">(</span><span class="nx">link</span><span class="p">))</span>
          <span class="k">break</span>
        <span class="p">}</span>
        <span class="nx">prev</span> <span class="o">=</span> <span class="nx">consider</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">basename</span><span class="p">.</span><span class="nx">readlink</span><span class="p">(</span><span class="nx">consider</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="nx">link</span> <span class="o">=</span> <span class="kc">undefined</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="kc">undefined</span> <span class="o">!==</span> <span class="nx">link</span><span class="p">)</span> <span class="nx">ins</span><span class="p">.</span><span class="nx">unshift</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">ins</span><span class="p">,</span> <span class="nx">split</span><span class="p">(</span><span class="nx">link</span><span class="p">))</span>
        <span class="k">else</span> <span class="nx">outs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">leaf</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">outs</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * returns the relative path from one path to another using only &quot;..&quot; to</span>
<span class="cm">   * traverse up to the two paths&#39; common ancestor. If the target is</span>
<span class="cm">   * omitted, returns the path to the source from the current working</span>
<span class="cm">   * directory</span>
<span class="cm">   * @param {String()} source</span>
<span class="cm">   * @param {String()} target</span>
<span class="cm">   * @returns {String}</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">relative</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">relative</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_separator</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_separator</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">target</span> <span class="o">=</span> <span class="nx">source</span>
      <span class="nx">source</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">workingDirectory</span><span class="p">()</span> <span class="o">+</span> <span class="nx">_separator</span>
    <span class="p">}</span>
    <span class="nx">source</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">absolute</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">absolute</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span>
    <span class="nx">source</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span>
    <span class="nx">target</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span>
    <span class="nx">source</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span>
      <span class="mi">0</span> <span class="o">!==</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span>
      <span class="mi">0</span> <span class="o">!==</span> <span class="nx">target</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span>
      <span class="nx">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span> <span class="p">{</span>
      <span class="nx">source</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span>
      <span class="nx">target</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!==</span> <span class="nx">source</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">source</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span>
      <span class="nx">target</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">target</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">_separator</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="kd">var</span> <span class="nx">PathTypeTrait</span> <span class="o">=</span> <span class="nx">Trait</span><span class="p">(</span>
  <span class="p">{</span> <span class="nx">_textPath</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
  <span class="p">,</span> <span class="nx">toString</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
  <span class="p">,</span> <span class="nx">constructor</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>

  <span class="p">,</span> <span class="nx">valueOf</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">valueOf</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
  <span class="p">}</span>
  <span class="cm">/**</span>
<span class="cm">   * Path instances inherit from the String prototype.</span>
<span class="cm">   * returns a Path object. Path is a chainable shorthand for working with</span>
<span class="cm">   * paths. Path objects have no more or less authority to manipulate the</span>
<span class="cm">   * file system that produces them. If multiple arguments are passed to</span>
<span class="cm">   * the Path constructor, they are joined to construct the corresponding</span>
<span class="cm">   * path. If an argument is an Array, as ascertained by Array.isArray, it</span>
<span class="cm">   * must conform to normal output of split, meaning that if the first</span>
<span class="cm">   * value is a drive or root, the components are joined absolutely, and</span>
<span class="cm">   * otherwise they are joined relatively.</span>
<span class="cm">   */</span>
<span class="p">,</span> <span class="nx">absolute</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">absolute</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">absolute</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">join</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">join</span><span class="p">(</span><span class="cm">/*paths...*/</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="nx">_slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span>
    <span class="nx">paths</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">,</span> <span class="nx">paths</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">split</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">split</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">resolve</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">resolve</span><span class="p">(</span><span class="cm">/*paths...*/</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="nx">_slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">)</span>
    <span class="nx">paths</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">resolve</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">,</span> <span class="nx">paths</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">to</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">to</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">target</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">from</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">from</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">base</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">base</span><span class="p">(</span><span class="nx">extension</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">base</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">extension</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">extension</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">extension</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">extension</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">canonical</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">canonical</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">canonical</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">path</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">directory</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">directory</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">directory</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">normal</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">normal</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">normal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">relative</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">relative</span><span class="p">(</span><span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_textPath</span><span class="p">.</span><span class="nx">relative</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">target</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">ObjectPathTrait</span> <span class="o">=</span> <span class="nx">Trait</span><span class="p">(</span>
<span class="p">{</span> <span class="nx">workingDirectory</span><span class="o">:</span> <span class="nx">Trait</span><span class="p">.</span><span class="nx">required</span>
<span class="p">,</span> <span class="nx">workingDirectoryPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">workingDirectoryPath</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">Path</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">workingDirectory</span><span class="p">())</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">Path</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">Path</span><span class="p">(</span><span class="nx">paths</span><span class="cm">/*, ...*/</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;string&#39;</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">paths</span><span class="p">)</span> <span class="o">?</span> <span class="nx">paths</span>
      <span class="o">:</span> <span class="p">(</span><span class="mi">1</span> <span class="o">===</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;&#39;</span> <span class="o">===</span> <span class="nx">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span>
      <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">paths</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;.&#39;</span>

    <span class="k">return</span> <span class="nx">PathTypeTrait</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
      <span class="p">{</span> <span class="nx">_textPath</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="k">this</span> <span class="p">}</span>
      <span class="p">,</span> <span class="nx">toString</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">}</span>
      <span class="p">,</span> <span class="nx">constructor</span><span class="o">:</span> <span class="p">{</span> <span class="nx">value</span><span class="o">:</span> <span class="nx">Path</span> <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">,</span> <span class="nx">path</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">paths</span><span class="cm">/*, ...*/</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">Path</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">FSPathsTrait</span> <span class="o">=</span> <span class="nx">Trait</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">TextPathTrait</span><span class="p">,</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">ObjectPathTrait</span><span class="p">)</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 